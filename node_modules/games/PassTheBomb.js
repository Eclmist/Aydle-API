var engine = require('AydleEngine/AydleEngine');
var gameLoop = engine.GameLoop;

function PassTheBomb(){}

let data = JSON.parse(process.argv[2]);

let socket = data.socket;
let io = data.io;
let sample = data.sample;

let gamerunning = false;
let targetNumber = -1;
let timeleft = 30.0;

gameLoop.SetPrepare(Start);
gameLoop.SetUpdate(Update);
gameLoop.Start();

function Start()
{
	gamerunning = true;
	console.log(gameLoop.GetDeltaTime());
    /*
    socket.on('pass', (time, number) =>
	{
		if (number === targetNumber) {

			let timer = time

			timeleft = timer
			targetNumber = GetRandNumber(1, 10)
			io.in(socket.currentRoom.code).emit('PassBomb', socket.currentRoom.GetNextTarget().playerID, timer, targetNumber)
		}
	})

	socket.on('generate', () =>
	{
		socket.emit('newRandomNumber', GetRandNumber(1,10))
	});
	*/
}

function Update()
{
    if(gamerunning === true)
    {
        console.log(timeleft);

        timeleft -= gameLoop.GetDeltaTime();

        
            if (timeleft <= 0) 
            {		
				io.in(socket.currentRoom.code).emit('explode')
				gamerunning = false
				timeleft = 30
            }
            
    }
    else
    {
        process.exit(0);
    }

}

function GetRandNumber(max, min) //both inclusive
{
	return Math.floor(Math.random() * (max - min + 1)) + min;
}



var DynamicGameClass = require('server/DynamicGameClass');
var gameInstance;
var io;

process.on('message', (data) => {
    
    if(data.name !== undefined && gameInstance === undefined){
        gameInstance = new DynamicGameClass(data.name);

        // if game does not exist
        if('start' in gameInstance === false){
            gameInstance = undefined;
        }
    }

    if(data.socket !== undefined && data.io !== undefined && gameInstance !== undefined
        && data.playerID !== undefined){
        gameInstance.playerManager.addPlayer(data.socket.id, data.playerID);
        gameInstance.setupGameHandlers(data.socket, data.io, data.playerID);
        if(io === undefined){
            io = data.io;
        }

    }

    if(data.canStart !== undefined && gameInstance !== undefined){   
        gameInstance.runGameInstance();
    }
});


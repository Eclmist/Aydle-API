var DynamicGameClass = require('server/DynamicGameClass');
var engine = require('AydleEngine/AydleEngine');
var gameLoop = engine.GameLoop;
var gameInstance;

process.on('message', (data) => {
    
    if(data.name !== undefined && gameInstance === undefined){
        gameInstance = new DynamicGameClass(data.name);
        if('start' in gameInstance === false){
            gameInstance = undefined;
        }
    }

    if(data.socket !== undefined && gameInstance !== undefined){
        gameInstance.setupGameHandlers(data.socket);
    }

    if(data.canStart !== undefined && gameInstance !== undefined){   
        gameLoop.setPrepare(gameInstance.start);
        gameLoop.setUpdate(gameInstance.update);
        gameLoop.start();
        
    }

});